<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Calendar 4</title>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <link href="./output.css" rel="stylesheet" />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
      integrity="sha512DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
      crossorigin="anonymous"
      referrerpolicy="noreferrer"
    />
  </head>

  <body
    class="bg-gradient-to-br from-[#1a1443] to-[#2a1d5c] min-h-screen flex items-center justify-center"
  >
    <div
      class="w-full max-w-4xl mx-auto bg-[#21194d] rounded-2xl shadow-2xl flex flex-col md:flex-row overflow-hidden"
    >
      <div class="flex-1 p-8">
        <div class="flex items-center justify-between mb-6">
          <button id="prevMonth" class="text-white text-2xl focus:outline-none">
            &#8592;
          </button>
          <div id="monthYear" class="text-white font-semibold text-lg"></div>
          <button id="nextMonth" class="text-white text-2xl focus:outline-none">
            &#8594;
          </button>
        </div>
        <div class="grid grid-cols-7 text-center text-white font-semibold mb-2">
          <div>Sun</div>
          <div>Mon</div>
          <div>Tue</div>
          <div>Wed</div>
          <div>Thu</div>
          <div>Fri</div>
          <div>Sat</div>
        </div>
        <div id="calendarDays" class="grid grid-cols-7 gap-2"></div>
      </div>

      <div
        class="w-full md:w-80 bg-[#241e4e] p-8 flex flex-col justify-between"
      >
        <div>
          <div
            id="selectedDate"
            class="text-white text-center font-semibold text-lg mb-2"
          ></div>
          <div
            id="eventList"
            class="flex flex-col items-center justify-center text-gray-400 min-h-[120px]"
          >
            <div class="flex flex-col items-center">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-12 w-12 mb-2 opacity-30"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                />
              </svg>
              <span>No events for this day</span>
            </div>
          </div>
        </div>
        <button
          id="addEventBtn"
          class="mt-8 w-full py-3 rounded-full bg-gradient-to-r from-pink-500 to-fuchsia-500 text-white font-bold shadow-lg hover:from-pink-400 hover:to-fuchsia-400 transition"
        >
          ADD EVENT
        </button>
      </div>
    </div>

    <div
      id="eventModal"
      class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden"
    >
      <div class="bg-[#241e4e] p-8 rounded-xl w-80">
        <h2 class="text-white text-lg font-semibold mb-4">Add Event</h2>
        <input
          id="eventInput"
          type="text"
          class="w-full p-2 rounded mb-4 bg-[#1a1443] text-white focus:outline-none"
          placeholder="Event name..."
        />
        <div class="flex justify-end gap-2">
          <button
            id="cancelEvent"
            class="px-4 py-2 rounded bg-gray-600 text-white"
          >
            Cancel
          </button>
          <button
            id="saveEvent"
            class="px-4 py-2 rounded bg-gradient-to-r from-pink-500 to-fuchsia-500 text-white font-bold"
          >
            Save
          </button>
        </div>
      </div>
    </div>
    <script>
      const monthNames = [
        "January",
        "February",
        "March",
        "April",
        "May",
        "June",
        "July",
        "August",
        "September",
        "October",
        "November",
        "December",
      ];
      let today = new Date();
      let currentMonth = today.getMonth();
      let currentYear = today.getFullYear();
      let selectedDay = today.getDate();
      let selectedMonth = currentMonth;
      let selectedYear = currentYear;
      let events = JSON.parse(localStorage.getItem("calendarEvents") || "{}");
      const monthYearEl = document.getElementById("monthYear");
      const calendarDaysEl = document.getElementById("calendarDays");
      const selectedDateEl = document.getElementById("selectedDate");
      const eventListEl = document.getElementById("eventList");
      const addEventBtn = document.getElementById("addEventBtn");
      const eventModal = document.getElementById("eventModal");
      const eventInput = document.getElementById("eventInput");
      const saveEventBtn = document.getElementById("saveEvent");
      const cancelEventBtn = document.getElementById("cancelEvent");
      function pad(n) {
        return n < 10 ? "0" + n : n;
      }
      function getDateKey(y, m, d) {
        return `${y}-${pad(m + 1)}-${pad(d)}`;
      }
      function renderCalendar() {
        monthYearEl.textContent = `${monthNames[currentMonth]}, ${currentYear}`;
        calendarDaysEl.innerHTML = "";
        const firstDay = new Date(currentYear, currentMonth, 1).getDay();
        const daysInMonth = new Date(
          currentYear,
          currentMonth + 1,
          0
        ).getDate();
        for (let i = 0; i < firstDay; i++) {
          calendarDaysEl.innerHTML += `<div></div>`;
        }
        for (let d = 1; d <= daysInMonth; d++) {
          const isToday =
            d === today.getDate() &&
            currentMonth === today.getMonth() &&
            currentYear === today.getFullYear();
          const isSelected =
            d === selectedDay &&
            currentMonth === selectedMonth &&
            currentYear === selectedYear;
          const dateKey = getDateKey(currentYear, currentMonth, d);
          const hasEvents = events[dateKey] && events[dateKey].length > 0;
          let eventDots = "";
          if (hasEvents) {
            eventDots = `<div class='flex justify-center mt-1 gap-0.5'>${events[
              dateKey
            ]
              .slice(0, 3)
              .map(
                (_, i) =>
                  `<span class='w-1.5 h-1.5 rounded-full ${
                    ["bg-pink-400", "bg-yellow-400", "bg-blue-400"][i % 3]
                  }'></span>`
              )
              .join("")}</div>`;
          }
          calendarDaysEl.innerHTML += `
          <button class="aspect-square w-full rounded-full flex flex-col items-center justify-center focus:outline-none transition
            ${
              isSelected
                ? "bg-pink-500 shadow-lg text-white"
                : isToday
                ? "ring-2 ring-pink-400 text-white"
                : "text-gray-200 hover:bg-[#2a1d5c]"
            }"
            data-day="${d}">
            <span>${d}</span>
            ${eventDots}
          </button>
        `;
        }
        Array.from(calendarDaysEl.querySelectorAll("button[data-day]")).forEach(
          (btn) => {
            btn.addEventListener("click", () => {
              selectedDay = parseInt(btn.getAttribute("data-day"));
              selectedMonth = currentMonth;
              selectedYear = currentYear;
              renderCalendar();
              renderEvents();
            });
          }
        );
      }
      function renderEvents() {
        const dateKey = getDateKey(selectedYear, selectedMonth, selectedDay);
        selectedDateEl.textContent = `${monthNames[selectedMonth]} ${selectedDay}, ${selectedYear}`;
        if (events[dateKey] && events[dateKey].length > 0) {
          eventListEl.innerHTML = events[dateKey]
            .map(
              (ev, i) => `
          <div class="flex items-center gap-2 text-white mb-2">
            <span class="w-2 h-2 rounded-full ${
              ["bg-pink-400", "bg-yellow-400", "bg-blue-400"][i % 3]
            }"></span>
            <span>${ev}</span>
          </div>
        `
            )
            .join("");
        } else {
          eventListEl.innerHTML = `<div class="flex flex-col items-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-12 w-12 mb-2 opacity-30" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" /></svg>
          <span>No events for this day</span>
        </div>`;
        }
      }
      document.getElementById("prevMonth").onclick = () => {
        currentMonth--;
        if (currentMonth < 0) {
          currentMonth = 11;
          currentYear--;
        }
        renderCalendar();
        renderEvents();
      };
      document.getElementById("nextMonth").onclick = () => {
        currentMonth++;
        if (currentMonth > 11) {
          currentMonth = 0;
          currentYear++;
        }
        renderCalendar();
        renderEvents();
      };
      addEventBtn.onclick = () => {
        eventModal.classList.remove("hidden");
        eventInput.value = "";
        eventInput.focus();
      };
      cancelEventBtn.onclick = () => {
        eventModal.classList.add("hidden");
      };
      saveEventBtn.onclick = () => {
        const val = eventInput.value.trim();
        if (!val) return;
        const dateKey = getDateKey(selectedYear, selectedMonth, selectedDay);
        if (!events[dateKey]) events[dateKey] = [];
        events[dateKey].push(val);
        localStorage.setItem("calendarEvents", JSON.stringify(events));
        eventModal.classList.add("hidden");
        renderCalendar();
        renderEvents();
      };
      eventInput.addEventListener("keydown", (e) => {
        if (e.key === "Enter") saveEventBtn.click();
      });
      eventModal.addEventListener("click", (e) => {
        if (e.target === eventModal) eventModal.classList.add("hidden");
      });
      // Initial render
      renderCalendar();
      renderEvents();
    </script>
  </body>
</html>
